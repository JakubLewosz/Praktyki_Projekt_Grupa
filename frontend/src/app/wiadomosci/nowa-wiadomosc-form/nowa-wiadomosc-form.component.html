<div class="form-container">
  <h2>Nowa Wiadomość</h2>
  <p>Wyślij wiadomość do administratora (UKNF).</p>

  <form [formGroup]="form" (ngSubmit)="wyslijWiadomosc()">
    
    <div class="form-group">
      <label for="grupaId">Wysyłaj z ramienia grupy *</label>
      <select id="grupaId" formControlName="grupaId" class="form-input">
        <option [ngValue]="null" disabled>Wybierz grupę...</option>
        @for (grupa of mojeGrupy; track grupa.id) {
          <option [ngValue]="grupa.id">{{ grupa.nazwa }}</option>
        }
      </select>
      @if (mojeGrupy.length === 0) {
        <div class="error-message">
          Nie jesteś przypisany do żadnej grupy (lub trwa ładowanie).
        </div>
      }
    </div>

    <div class="form-group">
      <label for="temat">Temat *</label>
      <input 
        id="temat" 
        type="text" 
        formControlName="temat" 
        class="form-input">
    </div>

    <div class="form-group">
      <label for="tresc">Treść Wiadomości *</label>
      <textarea 
        id="tresc" 
        formControlName="tresc" 
        class="form-textarea" 
        rows="10">
      </textarea>
    </div>

    <div class="form-actions">
      <button 
        type="button" 
        (click)="anuluj()" 
        class="button button-secondary"
        [disabled]="isSending()">
        Anuluj
      </button>
      
      <button 
        type="submit" 
        class="button button-primary" 
        [disabled]="form.invalid || isSending()">
        
        @if (isSending()) {
          <span>Wysyłanie...</span>
        } @else {
          <span>Wyślij</span>
        }
      </button>
    </div>

  </form>
</div>